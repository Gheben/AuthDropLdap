<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GBDrop - Test Bookmarklet</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 { color: #1976D2; }
        h2 { color: #FF6F00; margin-top: 30px; }
        .bookmarklet {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(135deg, #1976D2, #FF6F00);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin: 10px 0;
        }
        .bookmarklet:hover {
            opacity: 0.9;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .step {
            background: #e3f2fd;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #1976D2;
            border-radius: 3px;
        }
        .warning {
            background: #fff3e0;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #FF6F00;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>üöÄ GBDrop - Guida ai Bookmarklet</h1>
    
    <p>Questa pagina ti aiuta a creare e testare i bookmarklet per GBDrop.</p>

    <h2>üìå Metodo 1: Trascina questo link nei Preferiti</h2>
    
    <div class="step">
        <p><strong>Passo 1:</strong> Assicurati che la barra dei Preferiti sia visibile (Ctrl+Shift+B su Chrome/Edge)</p>
        <p><strong>Passo 2:</strong> Trascina questo link nella barra dei Preferiti:</p>
        
        <a href="javascript:(function(){const name=prompt('Inserisci il tuo nome utente:',document.querySelector('#display-name')?.getAttribute('placeholder')||'');if(name){const event=new CustomEvent('self-display-name-changed',{detail:name});window.dispatchEvent(event);alert('Nome impostato: '+name);}})();" class="bookmarklet">
            üè∑Ô∏è Imposta Nome GBDrop
        </a>
        
        <p><strong>Passo 3:</strong> Apri GBDrop e clicca sul bookmarklet appena aggiunto</p>
    </div>

    <h2>‚úèÔ∏è Metodo 2: Crea Manualmente il Bookmarklet</h2>
    
    <div class="step">
        <p><strong>Passo 1:</strong> Crea un nuovo Preferito (Ctrl+D)</p>
        <p><strong>Passo 2:</strong> Nome: <code>Imposta Nome GBDrop</code></p>
        <p><strong>Passo 3:</strong> URL: Copia il codice qui sotto</p>
        
        <div class="code-block">
            <code id="bookmarklet-code">javascript:(function(){const name=prompt('Inserisci il tuo nome utente:',document.querySelector('#display-name')?.getAttribute('placeholder')||'');if(name){const event=new CustomEvent('self-display-name-changed',{detail:name});window.dispatchEvent(event);alert('Nome impostato: '+name);}})();</code>
        </div>
        
        <button onclick="copyCode()" style="padding: 10px 20px; background: #1976D2; color: white; border: none; border-radius: 5px; cursor: pointer;">
            üìã Copia Codice
        </button>
    </div>

    <h2>üß™ Test del Bookmarklet</h2>
    
    <div class="step">
        <p>Puoi testare il bookmarklet qui prima di usarlo su GBDrop:</p>
        
        <div style="margin: 20px 0;">
            <div id="display-name" placeholder="Test User" style="padding: 10px; border: 2px dashed #1976D2; border-radius: 5px; display: inline-block;">
                Nome Corrente
            </div>
        </div>
        
        <button onclick="testBookmarklet()" style="padding: 10px 20px; background: #FF6F00; color: white; border: none; border-radius: 5px; cursor: pointer;">
            üß™ Testa Bookmarklet
        </button>
        
        <p id="test-result" style="margin-top: 10px; font-weight: bold;"></p>
    </div>

    <h2>üí° Come Usare</h2>
    
    <div class="step">
        <ol>
            <li>Apri GBDrop nel browser: <code>http://localhost:3000</code></li>
            <li>Clicca sul bookmarklet che hai salvato nei Preferiti</li>
            <li>Inserisci il tuo nome utente nella finestra che appare</li>
            <li>Il nome viene salvato automaticamente e persiste per sempre!</li>
        </ol>
    </div>

    <div class="warning">
        <strong>‚ö†Ô∏è Nota:</strong> Il bookmarklet funziona solo quando sei su una pagina GBDrop aperta. 
        Se lo clicchi su questa pagina di test, verr√† simulato il comportamento.
    </div>

    <h2>üîß Versioni Alternative del Bookmarklet</h2>
    
    <h3>Versione con Nome Utente Windows Preimpostato</h3>
    <p>Questa versione ti chiede direttamente di confermare il nome utente Windows:</p>
    
    <div class="code-block">
        <code>javascript:(function(){const name=prompt('Conferma il tuo nome utente Windows:','%USERNAME%');if(name){const event=new CustomEvent('self-display-name-changed',{detail:name});window.dispatchEvent(event);alert('Nome impostato: '+name);}})();</code>
    </div>
    
    <p><small>Nota: Sostituisci <code>%USERNAME%</code> con il tuo vero nome utente prima di salvare</small></p>

    <h3>Versione Silenziosa (senza alert)</h3>
    <p>Questa versione salva il nome senza mostrare messaggi:</p>
    
    <div class="code-block">
        <code>javascript:(function(){const name=prompt('Inserisci il tuo nome utente:',document.querySelector('#display-name')?.getAttribute('placeholder')||'');if(name){const event=new CustomEvent('self-display-name-changed',{detail:name});window.dispatchEvent(event);}})();</code>
    </div>

    <script>
        function copyCode() {
            const code = document.getElementById('bookmarklet-code');
            const textArea = document.createElement('textarea');
            textArea.value = code.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            alert('‚úÖ Codice copiato negli appunti!');
        }

        function testBookmarklet() {
            const name = prompt('Inserisci il tuo nome utente:', document.querySelector('#display-name')?.getAttribute('placeholder') || '');
            if (name) {
                document.getElementById('display-name').textContent = name;
                document.getElementById('test-result').textContent = '‚úÖ Nome impostato con successo: ' + name;
                document.getElementById('test-result').style.color = '#1976D2';
                
                // Simula l'evento
                const event = new CustomEvent('self-display-name-changed', {detail: name});
                window.dispatchEvent(event);
            }
        }

        // Listener per testare l'evento
        window.addEventListener('self-display-name-changed', (e) => {
            console.log('Evento self-display-name-changed ricevuto:', e.detail);
        });
    </script>
</body>
</html>
